<!DOCTYPE html>
<html lang="et">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚ò¢Ô∏è SendaFlip - REAL DANGER MODE</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #8B0000 0%, #000000 100%);
            min-height: 100vh;
            padding: 20px;
            color: white;
        }
        .danger-container {
            background: rgba(0, 0, 0, 0.8);
            border: 3px solid #ff0000;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 0 50px rgba(255, 0, 0, 0.5);
            max-width: 800px;
            margin: 0 auto;
        }
        .warning-header {
            text-align: center;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { color: #ff0000; }
            50% { color: #ff6666; }
            100% { color: #ff0000; }
        }
        .choice-btn {
            font-size: 20px;
            padding: 20px 40px;
            margin: 15px;
            border: 2px solid #ff0000;
            transition: all 0.3s;
        }
        .choice-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px #ff0000;
        }
        .result-message {
            background: rgba(255, 0, 0, 0.2);
            border: 1px solid #ff0000;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            white-space: pre-line;
        }
        .critical-file {
            background: rgba(255, 0, 0, 0.3);
            padding: 10px;
            border-radius: 5px;
            margin: 5px 0;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="danger-container">
        <div class="warning-header">
            <h1>‚ò¢Ô∏è SENDAFLIP - REAL DANGER MODE ‚ò¢Ô∏è</h1>
            <h3 class="text-danger">CRITICAL SYSTEM FILES AT RISK!</h3>
            <p class="text-warning">VM SNAPSHOT REQUIRED BEFORE PLAYING!</p>
        </div>
        
        <div class="alert alert-danger text-center">
            <h4>‚ö†Ô∏è EXTREME WARNING ‚ö†Ô∏è</h4>
            <p>If you lose, critical system files WILL be deleted!</p>
            <p>Targets: /boot/vmlinuz, /bin/bash, /etc/passwd, etc.</p>
            <p><strong>System may become UNBOOTABLE!</strong></p>
        </div>
        
        <div class="text-center mb-4">
            <h4>CHOOSE YOUR FATE:</h4>
            <button class="btn btn-danger choice-btn" onclick="choose('heads')">
                <h3>ü¶Ö KULL</h3>
            </button>
            <button class="btn btn-warning choice-btn" onclick="choose('tails')">
                <h3>üìÑ KIRI</h3>
            </button>
        </div>
        
        <div id="coinResult" class="text-center" style="font-size: 48px; margin: 30px 0;">
            ‚ö†Ô∏è
        </div>
        
        <div class="text-center">
            <button id="flipBtn" class="btn btn-lg btn-outline-danger" onclick="flipCoin()" disabled>
                <h2>üí£ FLIP THE COIN üí£</h2>
            </button>
        </div>
        
        <div id="resultMessage" class="result-message" style="display: none;"></div>
        
        <div class="mt-4">
            <h5>‚ö†Ô∏è Vulnerable System Files:</h5>
            {% for file in vulnerable_files %}
            <div class="critical-file">{{ file }}</div>
            {% endfor %}
        </div>
        
        <div class="text-center mt-4">
            <button class="btn btn-outline-info btn-sm" onclick="checkSystem()">
                Check System Status
            </button>
            <button class="btn btn-outline-success btn-sm" onclick="emergencyRestore()">
                Emergency Restore
            </button>
        </div>
        
        <div class="text-center text-muted small mt-4">
            <p>‚ò¢Ô∏è Git + Docker + GitHub Actions + Ansible ‚ò¢Ô∏è</p>
            <p>OS: {{ os_type }} | REAL DANGER MODE</p>
            <p class="text-danger">BACKUP VM SNAPSHOT BEFORE PLAYING!</p>
        </div>
    </div>
    
    <script>
        let currentChoice = null;
        
        function choose(choice) {
            currentChoice = choice;
            document.getElementById('flipBtn').disabled = false;
            document.getElementById('coinResult').innerHTML = choice === 'heads' ? 'ü¶Ö' : 'üìÑ';
        }
        
        function flipCoin() {
            if (!currentChoice) return;
            
            const flipBtn = document.getElementById('flipBtn');
            const resultMessage = document.getElementById('resultMessage');
            
            flipBtn.disabled = true;
            resultMessage.style.display = 'none';
            
            fetch('/flip', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ choice: currentChoice })
            })
            .then(response => response.json())
            .then(data => {
                resultMessage.style.display = 'block';
                resultMessage.className = `result-message ${data.success ? 'alert-success' : 'alert-danger'}`;
                
                let message = `<h4>${data.success ? '‚úÖ YOU WON!' : 'üí• YOU LOST!'}</h4>`;
                message += `<p>${data.message.replace(/\n/g, '<br>')}</p>`;
                
                if (data.danger) {
                    message += `<hr><h5>üí£ DESTRUCTION DETAILS:</h5>`;
                    if (data.destruction_result) {
                        message += `<p>File: ${data.destruction_result.file || 'Unknown'}</p>`;
                        if (data.destruction_result.backup) {
                            message += `<p>Backup: ${data.destruction_result.backup}</p>`;
                        }
                    }
                    message += `<p class="text-danger"><strong>${data.emergency || ''}</strong></p>`;
                    message += `<p class="text-warning">${data.reboot_warning || ''}</p>`;
                }
                
                resultMessage.innerHTML = message;
                
                if (!data.success) {
                    document.body.style.animation = 'shake 0.5s';
                    setTimeout(() => {
                        document.body.style.animation = '';
                    }, 500);
                }
                
                flipBtn.disabled = false;
            });
        }
        
        function checkSystem() {
            fetch('/system-check')
                .then(response => response.json())
                .then(data => {
                    alert(`System: ${data.os}\nDanger Level: ${data.danger_level}\n\n${data.warning}`);
                });
        }
        
        function emergencyRestore() {
            if (confirm('Attempt to restore from backups?')) {
                fetch('/emergency-restore')
                    .then(response => response.json())
                    .then(data => {
                        alert(`Restored: ${data.restored.length} files\n${data.message}\n\n${data.advice}`);
                    });
            }
        }
        
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0% { transform: translateX(0); }
                25% { transform: translateX(-10px); }
                50% { transform: translateX(10px); }
                75% { transform: translateX(-10px); }
                100% { transform: translateX(0); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
